# parapif-figures
This repository contains postprocessing scripts in MATLAB as well as the associated data for reproducing the figures in the paper "ParaPIF: A Parareal Approach for Parallel-in-Time Integration of Particle-in-Fourier schemes".

The data are generated by using the following tool chain (Stages 2024) on the JUWELS booster supercomputer
1) GCC/12.3.0
2) ParaStationMPI/5.9.2-1 built with CUDA/12
3) CMake/3.26.3

## Scripts for generating the figures

1) plot_local_error_vs_Pc_multiblock.m for Figure 1
2) plot_local_error_vs_grid_multiblock.m for Figure 2
3) plot_local_error_vs_time_step_size_coarse_pic_multiblock.m for Figures 3 and top row of Figure 4.
   Use `test_str='PenningTrap'`, `time_str='T_192_dt_003125'` and `coarse_dt=[0.4 0.2 0.1 0.05 0.025]` for top row of Figure 3,
   `test_str='PenningTrap'`, `time_str='T_12_dt_0001953125'` and `coarse_dt=[0.025 0.0125 0.00625 0.003125 0.0015625]` for bottom row of Figure 3.
   For Figure 4 top row use `test_str='LandauDamping'`, `time_str='T_192_dt_003125'` and `coarse_dt=[0.4 0.2 0.1 0.05 0.025]`
4) plot_local_error_vs_time_step_size_coarse_pif_multiblock.m for bottom row of Figure 4.
   Use `test_str='LandauDamping'`, `time_str='T_192_dt_003125'` and `coarse_dt=[0.4 0.2 0.1 0.05 0.025]`
5) plot_local_error_vs_nufft_epsilon_multiblock.m for Figure 5
6) plotDampingCycle.m for left figure in Figure 6
7) plotGrowthRateCycle.m for center figure in Figure 6
8) plotEnergyPIFCyclePenningTrap.m for right figure in Figure 6
9) plotEnergyPIFCycle.m for Figure 7. Use `test_str='LandauDamping'` for left figure and `test_str='TSI'` for right figure
10) plotChargePIFCycle.m for left figure in Figure 8
11) plotMomentumPIFCycle.m for Figure 8 (center and right figures). Use `test_str='LandauDamping'` for center figure and
    `test_str='TSI'` for right figure
12) plot_local_error_vs_iter_multiblock.m for Figure 9. Choose `test_str` to be `'LandauDamping'`,`'TSI'` and `'PenningTrap'`
    for left, center and right figures
13) plot_speedup_table.m for figures 10 and 11. For Figure 10 use `test='LandauDamping'` and for Figure 11 `test='PenningTrap'`.
    For left columns of both the figures use  `nspace='2'`,`fine_dt='05'`,`coarse_dt=[0.4 0.2 0.1 0.05]` and `coarse_tol = {'0.001';'0.01';'0.1';'PIC'}`
    whereas for right columns use `nspace='4'`,`fine_dt='003125'`,`coarse_dt=[0.2 0.05 0.0125 0.003125]` and `coarse_tol = {'0.00001';'0.0001';'0.001';'PIC'}`
14) Space_time_parallel_Juwels_Booster_paper.m for Figure 12  

